<html>
<body>
Сообщает о необработанных данных в неэкранированных EL-выражениях на JSP-страницах. Такие случаи могут привести к уязвимостям типа <a href="https://en.wikipedia.org/wiki/Cross-site_scripting">межсайтового скриптинга (XSS)</a>.
<p>
  В описании ниже используется термин <b>непомеченные</b> данные для обозначения безопасных и доверенных данных, в противоположность <b>помеченным</b> (небезопасным, недоверенным) данным. Дополнительную информацию см. в статье о <a href="https://en.wikipedia.org/wiki/Taint_checking">проверке на загрязнение</a>.
</p>
<p>
  Безопасными (непомеченными) объектами являются:
</p>
<ul>
  <li>Примитивные типы данных (кроме <code>char</code>)</li>
  <li>Результаты вызова методов, помеченных как untainted</li>
  <li>Результаты вызова функций экранирования</li>
  <li>Поля, помеченные как untainted</li>
</ul>
<p>
JSP-страницы могут иметь различные контексты для предоставленных данных, и если данные безопасны для одного контекста, это не обязательно означает, что они безопасны для всех контекстов.
Примеры см. в <a href="https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html#output-encoding">шпаргалке по предотвращению XSS-атак</a>. Эта проверка пропускает данные, помеченные как untainted (безопасные) во <b>всех</b> контекстах.
</p>
<p>
  Эта проверка поддерживает следующие варианты для пометки методов и полей как безопасных:
</p>
<ul>
  <li>Через использование любой аннотации из настраиваемого списка аннотаций untainted</li>
  <li>Через настройку списка безопасных методов и полей</li>
  <li>Все поля static final могут быть помечены как untainted путем выбора опции "Считать static final поля непомеченными" на вкладке "Непомеченные методы и поля"</li>
</ul>
<p>
  Эта проверка не подсвечивает места, где небезопасные данные достигают безопасных тегов на JSP-страницах.
  Например, тег <code>out</code> из JSTL taglib является безопасным, так как он по умолчанию экранирует заданные значения.
  Список безопасных тегов настраивается (можно определить весь диапазон, опустив значения <code>tag</code> или <code>attribute</code>).
</p>
<p>Быстрое исправление "Обернуть в тег JSTL &lt;out&gt;" оборачивает EL-выражение в тег JSTL <code>&lt;out&gt;</code>.</p>
<p>До:</p>
<pre>
  <code>
    ${foo}
  </code>
</pre>
<p>После:</p>
<pre>
  <code>
  &lt;%@ taglib prefix=&quot;c&quot; uri=&quot;http://java.sun.com/jsp/jstl/core&quot; %&gt;
&lt;c:out value=&quot;${foo}&quot;/&gt;
  </code>
</pre>
<p>"Обернуть в функцию JSTL escapeXml()" оборачивает небезопасное значение в функцию экранирования <code>escapeXml</code>.</p>
<p>До:</p>
<pre>
  <code>
  &lt;%@ taglib prefix=&quot;custom&quot; uri=&quot;WEB_INF/custom.tld&quot; %&gt;
  &lt;custom:tag value=&quot;${foo}&quot;/&gt;
  </code>
</pre>
<p>После:</p>
<pre>
  <code>
    &lt;%@ taglib prefix=&quot;custom&quot; uri=&quot;WEB_INF/custom.tld&quot; %&gt;
    &lt;%@ taglib prefix=&quot;fn&quot; uri=&quot;http://java.sun.com/jsp/jstl/functions&quot; %&gt;
    &lt;custom:tag value=&quot;${fn:escapeXml(foo)}&quot;/&gt;
  </code>
</pre>
<p>Доступны дополнительные быстрые исправления для добавления выбранных тегов в безопасные теги или для аннотирования соответствующих методов (или полей) с помощью аннотации untainted.</p>
<p>
  Можно добавить пользовательские функции экранирования (см. вкладку "Функции экранирования").
  В настоящее время она содержит функции из JSTL, возвращающие безопасные значения (например, известную функцию <code>escapeXml</code>).
  Не требуется определять функции JSTL дважды с разными URI пространств имён.
  Если используется один из URI http://java.sun.com/jsp/jstl/functions или http://java.sun.com/jstl/functions, другой также будет проверен. Функции экранирования также можно пропускать по имени в любом месте.
  Для этого оставьте поле URI пространства имён пустым.
</p>
</body>
</html>
