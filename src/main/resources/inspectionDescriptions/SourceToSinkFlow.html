<html>
<body>
Сообщает о случаях передачи небезопасных объектов в методы с параметрами, которые отмечены аннотацией <code>@Untainted</code>, возвращаются из аннотированных методов или присваиваются аннотированным полям, параметрам или локальным переменным. Не поддерживается использование Kotlin методов <code>set</code> и <code>get</code> полей в качестве точек входа.
<p>
  Безопасными объектами (в пределах одного класса) считаются:
<ul>
  <li>Строковые литералы, экземпляры интерфейсов или объекты перечислений</li>
  <li>Результаты вызовов методов, отмеченных как <code>@Untainted</code></li>
  <li>Приватные поля, инициализованные только строковыми литералами и имеющие безопасные инициализаторы</li>
  <li>Финальные поля с безопасными инициализаторами</li>
  <li>Локальные переменные или параметры, отмеченные как <code>@Untainted</code> и не получающие значения из небезопасных объектов</li>
  Такие поля, локальные переменные или параметры не должны передаваться в методы как аргументы или использоваться как квалификаторы, либо должны быть примитивами, их оболочками или неизменяемыми объектами.
</ul>
Кроме того, статические финальные поля также считаются безопасными.
<p>
  Анализ выполняется только в пределах одного файла. Для обработки зависимостей из других классов используйте опции.
  Анализ распространяется на приватные и статические методы и имеет ограничение по глубине распространения.
<p>
  Пример:
<pre>
<code lang="java">
  void doSmth(boolean b) {
    String s = safe();
    String s1 = "other";
    if (b) s1 = s;
    sink(s);
  }
  String sink(@Untainted String s) {}
</code>
</pre>
<p>
  В данном случае небезопасная строка не присваивается переменной <code>s</code>, поэтому предупреждение не возникает. С другой стороны:
<pre>
<code lang="java">
  void doSmth(boolean b) {
    String s = safe();
    String s1 = "other";
    s1 = foo();
    if (b) s = s1;
    sink(s);        // здесь будет предупреждение
  }
  String foo();
  String sink(@Untainted String s) {}
</code>
</pre>
<p>
  Здесь возникает предупреждение, так как <code>s1</code> имеет неизвестное состояние после присваивания результата вызова <code>foo</code>.
<p><small>Изменения в версии 2021.2</small></p>
</body>
</html>
